{% load static %}
<table id="addOrgsTable" class="table table-bordered table-hover mt-0" style="width: 100%;">
    <thead>
        <tr>
            <th> Sr. No. </th>
            <th nowrap=""> Employee No.  </th>
            <th nowrap=""> Associate Name </th>
            <th nowrap=""> Father Name  </th>
            <th nowrap=""> Department  </th>
            <!--<th nowrap=""> DOJ  </th>-->
            {% for months in month_list %}
            <th colspan="3" style=" padding: 1px; text-align: center;"> {{months}} </th>
            {% endfor %}
            <th style="text-align: center;"> Total Present </th>
            <th style="text-align: center;"> Total Absent  </th>
        </tr>
    </thead>
    <tbody>
        {% if staffs %}
{% for staff in staffs %}
<tr>
<td >{{forloop.counter}}.</td>
<td>{{ staff.emp_sap_id }}</td>
<td nowrap="" >
<a href="{% url 'src:staff-attendance-reports' staff.id dateForMonthlyAttendance %}">{% if staff.first_name %}{{ staff.first_name }}{% endif %} {% if staff.middle_name %}{{ staff.middle_name }}{% endif %} {% if staff.last_name %} {{ staff.last_name }}{% endif %}</a> 
<br><span style="font-size: 10px;">({{ staff.role_name }})</span></td>
<td>{{ staff.father_name }}</td>
<td>{{ staff.department_name }}</td>
<!--<td>{{ staff.date_of_joining }}</td>-->
{% for attendance in staff.attendances %}

    <td class="sorter-false"  colspan="3" style=" padding: 1px; text-align: center; margin-top: 3%; vertical-align:middle;">
        {% if attendance.attendance_status == 'P' %}
        <span class="present" title="{% if attendance.in_time != '' %}{{attendance.in_time|date:'H:i' }} - {% if attendance.out_time != None %}{{attendance.out_time|date:'H:i'}} {% else %}Not marked{% endif %}{% else %}Attendance Regularized{% endif %}">{{attendance.attendance_status}}</span>
        {% elif attendance.attendance_status == 'A' %}
        <span class="absent">{{attendance.attendance_status}}</span>
        {% elif attendance.attendance_status in leave_types %}
        <span class="leave">{{attendance.attendance_status}}</span>
        {% else %}
            <span class="holiday">{{attendance.attendance_status}}</span>
        {% endif %}
    </td>
{% endfor %}
<td style="text-align: center;">{{staff.present_count}} ({{staff.attendance_percentage|floatformat}}%)</td>
<td style="text-align: center;">{{staff.absent_count}}</td>
</tr>
{% endfor %}
{% else %}
<tr>


<th colspan="100" style=" padding: 0px; text-align: center;"> No Record Found...
</th>

</tr>
{% endif %}
    </tbody>
</table>

<script>
    $('#attendance_percentage').text('{{attendance_percentage|floatformat}}%')
</script>